---
import PostTitle from "../components/PostTitle.astro";
import ProfileCard from "../components/ProfileCard.astro";
import { Icon } from "astro-icon";

const { frontmatter } = Astro.props;
const url = `${import.meta.env.DEV_URL}/api/articles/${frontmatter.articleId}?populate=cover`
const token = import.meta.env.DEV_TOKEN
const config = {
  headers: {
      Authorization : `Bearer ${token}`
    },
}

const response = await fetch(url, config)
const value = await response.json()
const { attributes: article } = value?.data
console.log(article)
---

<section>
  <div id="" class="p-8 flex justify-center">
    <div class="w-3/4 max-w-3/4 p-8">
      <div>
        <div class="py-2 mb-8">
          <PostTitle text={article.title} />
        </div>
        <div
          class="w-full flex flex-col justify-center align-center left-0 border-b pb-4"
        >
          <img
            id="title-image"
            src={`${import.meta.env.DEV_URL}${article.cover.data.attributes.url}`}
            alt={article.cover.data.attributes.name}
            class="w-full object-cover rounded-lg"
          />
          <ProfileCard
            author={article.author}
            authorJob={article.authorJob}
            authorCompany={article.authorCompany}
            authorProfilePicture={article.authorProfilePicture}
          />
          <div class="text-center mt-4 text-italic">
            <p class="justify-self-center text-[0.6rem]">03 January 2023</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="mb-12">
  <div class="p-8 flex justify-center">
    <div class="w-3/4 max-w-3/4 px-12 text-sm">
      <slot />
    </div>
  </div>
</section>

<section class="border-t-1 border-main p-2 flex">
  <div class="w-full">
    <div class="p-4 py-6 flex justify-center items-center align-middle h-full bg-slate-800 rounded-full">
      <div class="flex">
        <Icon
          name="fa-solid:dice-d20"
          class="text-white cursor-pointer mr-4 transition ease-in-out hover:scale-[1.2] duration-300 "
          rotate="90deg"
          width="50px"
          height="50px"
        />
        <div class="cursor-default font-bold text-white flex justify-center items-center text-xl">
          Next article
        </div>
      </div>
    </div>
  </div>
</section>

<a
  class="p-6 w-20 h-20 fixed bottom-5 right-5 rounded-full cursor-pointer hover:bg-slate-100 transition ease-out"
  href="#"
>
  <Icon name="bytesize:chevron-top" />
</a>

<style>
  @import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap");

  section {
    font-family: "Montserrat", sans-serif;
    min-width: 450px;
    color: black;
  }

  #title-container {
    height: 425px;
  }

  #title-image {
    height: 300px;
  }

  :root {
    scroll-behavior: smooth;
  }

  .text-neon {
    background-color: #85ffbd;
    background-image: linear-gradient(45deg, #85ffbd 0%, #fffb7d 100%);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
  }
</style>
